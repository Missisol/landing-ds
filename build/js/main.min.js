"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}var SubmitForm=function(){function t(e,n,i,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};_classCallCheck(this,t),this.inputNames=n,this.apiURL=e,this.formSelector=i,this.formEl=a,this.formValue=o}return _createClass(t,[{key:"init",value:function(){var t=this;this.formEl=document.querySelector(this.formSelector),this.formEl.addEventListener("submit",(function(e){return t.formSubmit(e)}))}},{key:"formSubmit",value:function(t){t.preventDefault(),this.validate()&&(this.inputStringify(),this.fetchForm())}},{key:"validate",value:function(){var t=!0,e=!0,n=!1,i=void 0;try{for(var r,a=this.inputNames[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var o=r.value,l=this.formEl["".concat(o)];"userName"===l.name&&(this.checkName(l)||(t=!1)),"userPhone"===l.name&&(this.checkPhone(l,"")||(t=!1))}}catch(t){n=!0,i=t}finally{try{e||null==a.return||a.return()}finally{if(n)throw i}}return t}},{key:"checkName",value:function(t){var e=null;return/[^a-zа-я]|(^$)/gi.test(t.value)&&(e=""===t.value?"Поле не должно быть пустым":"Поле должно содержать только буквы"),this.validFunction(t,e)}},{key:"checkPhone",value:function(t){var e=null;return""===t.value&&(e="Поле не должно быть пустым"),this.validFunction(t,e)}},{key:"validFunction",value:function(t,e){var n=!0;return null!==e?(this.setInvalidField(t,e),n=!1):this.setValidField(t),n}},{key:"setInvalidField",value:function(t,e){document.querySelector(".contacts__field-".concat(t.name)).innerHTML=e}},{key:"setValidField",value:function(t){document.querySelector(".contacts__field-".concat(t.name)).innerHTML=""}},{key:"inputStringify",value:function(){var t="",e=!0,n=!1,i=void 0;try{for(var r,a=this.inputNames[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var o=r.value,l=this.formEl["".concat(o)];t+="".concat(o,"=").concat(l.value,"; ")}}catch(t){n=!0,i=t}finally{try{e||null==a.return||a.return()}finally{if(n)throw i}}return t=t.trim()}},{key:"fetchForm",value:function(){var t=this;this.formValue.input=this.inputStringify(),console.log(this.formValue),fetch(this.apiURL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.formValue)}).then((function(t){return t.json()})).then((function(e){t.accept()})).catch((function(t){return console.log(t)})),this.accept()}},{key:"accept",value:function(){this.formEl.classList.add("unvisible"),document.querySelector(".contacts__accept").classList.add("show")}}]),t}(),api="http://localhost:3000/api/users",inputs=["userName","userPhone"],formSelector=".contacts__form",btnSubmit=".contacts__submit",send=new SubmitForm(api,inputs,formSelector,btnSubmit);send.init();